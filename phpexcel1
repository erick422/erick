
 Logo
HOME
PHP
MYSQL
JQUERY
C SHARP
CSS
PYTHON
OCIO
RECURSOS
TUTORIALES

Buscar
CREAR UN REPORTE EN EXCEL CON PHP Y MYSQL
13 / SEP / 2013
CATEGORIAS: MYSQL / PHP

 
En este post les trigo un ejemplo para crear un reporte en Excel con PHP y una base de datos MySQL, la librer√≠a que se va a utilizar es PHPExcel.

PHPEXCEL
PHPExcel es una librer√≠a escrita en PHP  integrada por un conjunto de clases que permiten escribir y leer diferentes formatos de archivos de hojas de c√°lculo  como .xls, . xlsx, .csv,  .ods, PDF, HTML, ‚Ä¶ Este proyecto se basa en el est√°ndar OpenXML Microsoft y PHP.

Pagina Oficial y descarga

¬øEN QU√â CONSISTE EL EJEMPLO?
El ejemplo va a consistir en extraer de la base de datos una lista de alumnos ordenados por carrera, los cuales ser√°n presentados en una hoja de c√°lculo de Excel y se les aplicar√° formato a las celdas(Fuente, tama√±o, alineaci√≥n, bordes, relleno, etc). Bueno ahora que sabemos que es lo que vamos a hacer podemos comenzar.

BASE DE DATOS
CREATE TABLE IF NOT EXISTS `repexcel`.`alumno` (
 `numcontrol` INT UNSIGNED NOT NULL AUTO_INCREMENT ,
 `paterno` VARCHAR(15) NOT NULL ,
 `materno` VARCHAR(55) NOT NULL ,
 `nombre` VARCHAR(15) NOT NULL ,
 `sexo` ENUM('F','M') NOT NULL ,
 `fechanac` DATE NOT NULL ,
 `idcarrera` INT UNSIGNED NOT NULL ,
 PRIMARY KEY (`numcontrol`) ,
 INDEX `fk_alumno_carrera_idx` (`idcarrera` ASC) ,
 CONSTRAINT `fk_alumno_carrera`
 FOREIGN KEY (`idcarrera` )
 REFERENCES `repexcel`.`carrera` (`idcarrera` )
 ON DELETE NO ACTION
 ON UPDATE NO ACTION)
ENGINE = InnoDB
 
CREATE TABLE IF NOT EXISTS `repexcel`.`carrera` (
 `idcarrera` INT UNSIGNED NOT NULL AUTO_INCREMENT ,
 `carrera` VARCHAR(50) NOT NULL ,
 PRIMARY KEY (`idcarrera`) )
ENGINE = InnoDB
 
&nbsp;
ARCHIVO HTML
Con lo que voy a comenzar es creando un archivo HTML en el cual solo voy a colocar un t√≠tulo y un hiperv√≠nculo para descargar el reporte.

<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8" />
      <title>Reporte de excel con PHP y MySQL</title>
   </head>
   <body>
      <div>
        <header>
           <h1>REPORTE DE EXCEL CON PHP Y MYSQL</h1>
        </header>
        <div>
           <a href="reporteexcel.php"> Haz clic para descargar el reporte</a>
        </div>
      </div>
   </body>
</html>
ARCHIVO PHP
Ahora toca el turno de crear el archivo PHP que se va a encargar de generar el reporte, voy a ir explicando el contenido de este archivo poco a poco.

Lo primero es crear la conexi√≥n a la base de datos y verificar si se pudo conectar al servidor de lo contrario el programa terminar√≠a hasta aqu√≠ y mandar√≠a el error.

$conexion = new mysqli('localhost','usuario','password','basedatos',3306);
if (mysqli_connect_errno()) {
   printf("La conexi√≥n con el servidor de base de datos fall√≥: %s\n", mysqli_connect_error());
   exit();
}
Una vez que se realiz√≥ la conexi√≥n al servidor de base de datos procedemos a ejecutar la consulta de selecci√≥n para obtener los datos del reporte.

$consulta = "SELECT concat(paterno,' ', materno, ' ' , nombre) AS alumno, fechanac, sexo, carrera FROM alumno ";
$consulta .= " INNER JOIN carrera ON alumno.idcarrera = carrera.idcarrera ORDER BY carrera, nombre";
 
$resultado = $conexion->query($consulta);
Lo siguiente es verificar que la consulta obtuvo los registros a mostrar y lo hacemos con la siguiente condici√≥n, si el n√∫mero de registros es mayor que 0 quiere decir que si se obtuvieron datos por lo tanto procedemos a crear el reporte.

if($resultado->num_rows > 0 ){
Lo primero que hacemos es definir la zona horaria, debido a que vamos a trabajar con datos de tipo fecha y luego manda un error si no tenemos asignada una zona horaria, en este caso voy a asignar la de la ciudad de M√©xico, puedes consultar los datos de la zona horaria desde aqu√≠: Listado de zonas horarias.

date_default_timezone_set('America/Mexico_City');
La siguiente l√≠nea determina si se est√° accediendo al archivo v√≠a HTTP o CLI(command line interface), el archivo solo se va a mostrar si se accede desde un navegador web(HTTP).

if (PHP_SAPI == 'cli')
    die('Este archivo solo se puede ver desde un navegador web');
Ahora si comenzamos a armar el reporte de Excel

/** Se agrega la libreria PHPExcel */
 require_once 'lib/PHPExcel/PHPExcel.php';
 
// Se crea el objeto PHPExcel
 $objPHPExcel = new PHPExcel();
Comenzamos agregando las propiedades del archivo de Excel, estas las podemos ver una vez que se haya guardado el archivo haciendo ‚ÄúClic derecho > Propiedades > Detalles‚Äù

// Se asignan las propiedades del libro
$objPHPExcel->getProperties()->setCreator("Codedrinks") // Nombre del autor
    ->setLastModifiedBy("Codedrinks") //Ultimo usuario que lo modific√≥
    ->setTitle("Reporte Excel con PHP y MySQL") // Titulo
    ->setSubject("Reporte Excel con PHP y MySQL") //Asunto
    ->setDescription("Reporte de alumnos") //Descripci√≥n
    ->setKeywords("reporte alumnos carreras") //Etiquetas
    ->setCategory("Reporte excel"); //Categorias
Para los t√≠tulos del reporte voy a crear dos variables, de esta forma es un poco m√°s f√°cil realizar algunos cambios si es que el reporte fuera muy extenso.

$tituloReporte = "Relaci√≥n de alumnos por carrera";
$titulosColumnas = array('NOMBRE', 'FECHA DE NACIMIENTO', 'SEXO', 'CARRERA');
El reporte como ya se habr√°n dado cuenta va a tener solo 4 columnas: Nombre, Fecha de nacimiento, sexo y carrera. Por lo tanto solo vamos a ocupar hasta la columna D.

// Se combinan las celdas A1 hasta D1, para colocar ah√≠ el titulo del reporte
$objPHPExcel->setActiveSheetIndex(0)
    ->mergeCells('A1:D1');
 
// Se agregan los titulos del reporte
$objPHPExcel->setActiveSheetIndex(0)
    ->setCellValue('A1',$tituloReporte) // Titulo del reporte
    ->setCellValue('A3',  $titulosColumnas[0])  //Titulo de las columnas
    ->setCellValue('B3',  $titulosColumnas[1])
    ->setCellValue('C3',  $titulosColumnas[2])
    ->setCellValue('D3',  $titulosColumnas[3]);
Como pueden apreciar para asignar contenido a una celda se selecciona primero la hoja con setActiveSheetIndex(Indice de hoja) y despu√©s con setCellValue(celda, valor) asignamos el contenido a la celda deseada.

Ahora procedemos a rellenar las columnas con la informaci√≥n de los alumnos, para ello vamos a recorrer el resultado utilizando un while, las celdas se van a rellenar de forma parecida al paso anterior solo que aqu√≠ para indicar el n√∫mero de fila se va a utilizar una variable que se va a estar incrementando cada vez que se rellene la informaci√≥n de un alumno.

//Se agregan los datos de los alumnos
 
 $i = 4; //Numero de fila donde se va a comenzar a rellenar
 while ($fila = $resultado->fetch_array()) {
     $objPHPExcel->setActiveSheetIndex(0)
         ->setCellValue('A'.$i, $fila['alumno'])
         ->setCellValue('B'.$i, $fila['fechanac'])
         ->setCellValue('C'.$i, $fila['sexo'])
         ->setCellValue('D'.$i, $fila['carrera']);
     $i++;
 }
Hasta este punto ya se tiene el archivo con los datos ahora procedemos a aplicar el formato a las celdas. Para ello vamos a crear 3 variables, la primera va a contener el estilo del t√≠tulo del reporte, la segunda el estilo del t√≠tulo de las columnas y la tercera el estilo de la informaci√≥n de los alumnos.

$estiloTituloReporte = array(
    'font' => array(
        'name'      => 'Verdana',
        'bold'      => true,
        'italic'    => false,
        'strike'    => false,
        'size' =>16,
        'color'     => array(
            'rgb' => 'FFFFFF'
        )
    ),
    'fill' => array(
      'type'  => PHPExcel_Style_Fill::FILL_SOLID,
      'color' => array(
            'argb' => 'FF220835')
  ),
    'borders' => array(
        'allborders' => array(
            'style' => PHPExcel_Style_Border::BORDER_NONE
        )
    ),
    'alignment' => array(
        'horizontal' => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        'vertical' => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        'rotation' => 0,
        'wrap' => TRUE
    )
);
 
$estiloTituloColumnas = array(
    'font' => array(
        'name'  => 'Arial',
        'bold'  => true,
        'color' => array(
            'rgb' => 'FFFFFF'
        )
    ),
    'fill' => array(
        'type'       => PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR,
  'rotation'   => 90,
        'startcolor' => array(
            'rgb' => 'c47cf2'
        ),
        'endcolor' => array(
            'argb' => 'FF431a5d'
        )
    ),
    'borders' => array(
        'top' => array(
            'style' => PHPExcel_Style_Border::BORDER_MEDIUM ,
            'color' => array(
                'rgb' => '143860'
            )
        ),
        'bottom' => array(
            'style' => PHPExcel_Style_Border::BORDER_MEDIUM ,
            'color' => array(
                'rgb' => '143860'
            )
        )
    ),
    'alignment' =>  array(
        'horizontal'=> PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
        'vertical'  => PHPExcel_Style_Alignment::VERTICAL_CENTER,
        'wrap'      => TRUE
    )
);
 
$estiloInformacion = new PHPExcel_Style();
$estiloInformacion->applyFromArray( array(
    'font' => array(
        'name'  => 'Arial',
        'color' => array(
            'rgb' => '000000'
        )
    ),
    'fill' => array(
  'type'  => PHPExcel_Style_Fill::FILL_SOLID,
  'color' => array(
            'argb' => 'FFd9b7f4')
  ),
    'borders' => array(
        'left' => array(
            'style' => PHPExcel_Style_Border::BORDER_THIN ,
      'color' => array(
              'rgb' => '3a2a47'
            )
        )
    )
));
La forma m√°s r√°pida de dar formato a las celdas es a trav√©s de arreglos en los cuales se define todo el conjunto de formato que deseamos aplicar a las celdas. Veamos c√≥mo se aplican.

$objPHPExcel->getActiveSheet()->getStyle('A1:D1')->applyFromArray($estiloTituloReporte);
$objPHPExcel->getActiveSheet()->getStyle('A3:D3')->applyFromArray($estiloTituloColumnas);
$objPHPExcel->getActiveSheet()->setSharedStyle($estiloInformacion, "A4:D".($i-1));
Como pueden ver el formato se aplic√≥ de 2 formas diferentes una con getStyle(celda)->applyFromArray($arreglo) y la otra con setSharedStyle($estilo, celdas). ¬øCu√°l es la diferencia entre una y otra?, esto lo podemos apreciar cuando se aplican bordes: con la primer opci√≥n por ejemplo si se indica que se van a aplicar bordes superiores a las celdas desde B5 hasta F15, solo estar√≠a aplicando el borde superior a la fila 5 debido a que toma el rango como si fuera una sola celda. En cambio con la segunda opci√≥n los bordes superiores se aplicar√≠an a todas las filas desde la 5 hasta la 15 digamos que el formato se aplica a cada celda del rango indicado.

Ahora procedemos a asignar el ancho de las columnas de forma autom√°tica en base al contenido de cada una de ellas y lo hacemos con un ciclo de la siguiente forma.

for($i = 'A'; $i <= 'D'; $i++){
    $objPHPExcel->setActiveSheetIndex(0)->getColumnDimension($i)->setAutoSize(TRUE);
}
Bien, ahora solo agregamos algunos detalles mas

// Se asigna el nombre a la hoja
$objPHPExcel->getActiveSheet()->setTitle('Alumnos');
 
// Se activa la hoja para que sea la que se muestre cuando el archivo se abre
$objPHPExcel->setActiveSheetIndex(0);
 
// Inmovilizar paneles
//$objPHPExcel->getActiveSheet(0)->freezePane('A4');
$objPHPExcel->getActiveSheet(0)->freezePaneByColumnAndRow(0,4);
Ya para terminar vamos a enviar el archivo para que el usuario lo descargue.

// Se manda el archivo al navegador web, con el nombre que se indica, en formato 2007
header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
header('Content-Disposition: attachment;filename="Reportedealumnos.xlsx"');
header('Cache-Control: max-age=0');
 
$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');
$objWriter->save('php://output');
exit;
}
else{
    print_r('No hay resultados para mostrar');
}
OK, con eso se termina este ejercicio, m√°s abajo est√° el link para que descarguen el ejemplo, para m√°s informaci√≥n sobre esta librer√≠a puedes revisar su documentaci√≥n o dejar alg√∫n comentario.

Si el contenido te fue de utilidad dale me gusta a nuestra p√°gina de Facebook.

download

COMP√ÅRTELO:
Facebook41TwitterGoogleTumblrPinterestRedditLinkedIn1
RELACIONADO
Como integrar la libreria fpdf con el framework codeigniter
Como integrar la libreria fpdf con el framework codeigniter
En "CodeIgniter"
Crear un reporte con FPDF usando PHP y MySQL
En este post realizaremos un historial cl√≠nico de un paciente, en el cual contendr√° los datos generales del paciente y un listado de las consultas m√©dicas que realizo, el historial estar√° en formato PDF. Para realizar esto utilizaremos: el lenguaje de programaci√≥n PHP, el gestor de base de datos MySQL‚Ä¶
En "MySQL"
Ejemplo de Drag and Drop jQuery con PHP y MySQL
Ejemplo de Drag and Drop jQuery con PHP y MySQL
En "jQuery"

 
denker
ACERCA DEL AUTOR: DENKER
68 COMENTARIOS EN ‚ÄúCREAR UN REPORTE EN EXCEL CON PHP Y MYSQL‚Äù
ANDRES dice:
25 noviembre, 2013 a las 8:01
Probare este sistema de reportes.

Responder
Eminson Mendoza dice:
4 diciembre, 2013 a las 12:21
Muy bueno me sirvi√≥ de mucho :)

Responder
Janett dice:
6 enero, 2014 a las 20:01
Muy buena aportacion, gracias por la ayuda!!!

Responder
alejandro dice:
21 enero, 2014 a las 14:36
Facil, me anduvo de una!

Responder
Williams Nasser dice:
1 febrero, 2014 a las 18:56
Excelente ejemplo muchisimas gracias, falto algunos parametros como por ejemplo establecer filtros y tambien algo que no e encontrado establecer tipo de datos como por ejemplo fecha, y establecer formulas pero en general doy 100 puntos

Responder
Rosy dice:
3 febrero, 2014 a las 21:53
Si necesito hacer un libro de excel con varias hojas, c√≥mo lo hago???? Es urgente, please!!!!

Responder
denker dice:
4 febrero, 2014 a las 12:28
Puedes revisar la documentaci√≥n aqu√≠ te dejo un link que te puede servir

https://github.com/PHPOffice/PHPExcel/blob/develop/Documentation/markdown/Overview/06-Worksheets.md

saludos

Responder
aha dice:
4 febrero, 2014 a las 9:41
muchas gracias me ayudaste bastante XD

Responder
Fernando dice:
20 febrero, 2014 a las 11:32
Excelente‚Ä¶! me esta sirviendo mucho, hay forma de agregarle una imagen al reporte??

Responder
carlos dice:
27 febrero, 2014 a las 10:14
sos mostro tio!!!!!!!! he estado buscando esto por todos lados me has salvado el pellejo, y no solo lo creas si no que lo personalisas muy bn excelente excelente =)

Responder
oscar castro fernandez dice:
11 marzo, 2014 a las 17:05
me marca error al crear la tabla

#1064 ‚Äì You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‚ÄòCREATE TABLE IF NOT EXISTS `repexcel`.`carrera` (
`idcarrera` INT UNSIGNED NOT‚Äô at line 17

Responder
Hugo dice:
18 marzo, 2014 a las 19:53
Hola, ser√≠a bueno que pongan ya el script para crear la base de datos porque al copiar pegar no funciona, da varios errores. Saludos.

Responder
yo dice:
21 marzo, 2014 a las 17:23
no me sirvio
:(

Responder
hfx dice:
25 marzo, 2014 a las 18:19
excelso , excelente explicaci√≥n. hace mucho use esta librer√≠a , y veo que en 3 a√±os a evolucionado mucho y es mucho mas √∫til que en sus inicio.

Responder
PPK17 dice:
25 marzo, 2014 a las 22:26
Me sirvi√≥ de mucho y lo complement√© con la documentaci√≥n y los ejemplos q trae la libreria. Ahi van a encontrar m√°s cosas que no pudieran encontrar aqui, as√≠ q se se las recomiendo leerlas y analizarlas tambien.

Responder
Francisco dice:
28 marzo, 2014 a las 15:31
Hola lo ocupe de forma local en mi pc para generar el reporte y ni un problema pero luego lo sub√≠ a la web y me arroja el archivo vaci√≥ y el excel me arroja que no puede abrir el archivo por que el formato o la extensi√≥n no son validos
a nadie mas le paso eso ??

Responder
Mike dice:
4 abril, 2014 a las 14:03
Me aparece un mensaje que dice ‚ÄúExcel no puede abrir el archivo Reportedealumnos.xlsx porque el formato o la extension de este no son validos‚Äù‚Ä¶‚Ä¶.. Que hago??

Responder
sun2012 dice:
16 mayo, 2014 a las 10:06
Solo dale abrir, no pasa nada excel lo identifica y lo abre de todos modos, saludos.

Responder
Miguel dice:
6 abril, 2014 a las 17:30
al llegar al final , osea al generar el archivo me lo genera con errores y cuando lo abro solo son simbolos asi :

√è?K√∫my¬Ω√º¬Ω\-√≤t¬Ü%sJ¬æ/¬ø√æPK¬â¬í¬ÜD√ÆW√î}¬ïedocProps/core.xml¬•¬ì[o√£ ¬Ö√ü√ª+√Ø8¬Ω¬®¬µW√™M√ª√êH√ôM¬™√ùW S¬á√ñd√Ø¬Ø_ ¬â√´^*U√≤:√ü¬ú¬ô9¬ó¬ó√õ¬∂A√Å:¬©√ï√ß¬ä(¬Æ¬ÖT√µ?¬¨√Æ¬≤s¬å¬úgJ¬∞F+¬ò√°¬æ¬¨¬éJn ¬Æ-,¬¨6`¬Ω¬á¬Ç¬ër73¬º√∂√û¬Ñ8¬æ¬Ü¬ñ¬πI T¬ü¬¥m¬ôO[√É√∏¬´¬ÅL)=#-x&¬òg$ffp√Ñ{K√ÅK¬≥¬±M2¬ú@-(√ØH>√â√â+√´√Å¬∂√Æ√ì¬Ç¬§¬å√àV√∫√û√Ä¬ß√®A√®¬≠¬ì√òu√ù¬§;Nh¬ò?‚Äô√¶√∑√ã¬¥j&U¬å¬ä¬ÆJ√Ån¬Åym¬´¬π¬¨7√ê,¬É¬∞¬Ü%)1√Ö¬Ü9?y?IW√Ω{√∏#P√ÆW√ú¬ô¬Ä@a¬¥b¬∑√àA√π}|}¬≥¬∫√É√ï¬î√¶‚Äô √ü√ô*?/¬¶¬¥√à/2zZP¬áxc√≤√™√ö√Æ;}√è√∂√†¬ír√∞√í7P√Ω¬£¬≠t¬ª√•√ê ¬ÆZ√ºX √ç√ª√•√è√ª¬î√ä¬é¬ã¬∑√í√∏p¬ìC¬ù¬Äx¬ò ¬ª¬Ñ¬è¬°X√§6¬è√è√Ä√Ω√à√ø√¥¬ù¬∂√ÇUv_6j2¬ñ√ì√Å¬á¬®jm√ª¬°√Ñ¬â¬§√ù√´√ç¬üQ√ΩPK¬â¬í¬ÜDs¬ë{Y¬≥¬¶xl/theme/theme1.xml√≠YOo√õ6¬ø√ØS¬∫¬∑¬≤l√âu¬Ç:E√¨√ò√´√ñ¬¶ ¬∑C¬è¬¥DK¬¨)Q √©¬§¬æ √≠q√Ä¬Äa√ù¬∞√ã¬Ä√ùv¬∂h¬Å]¬∫O¬ì¬≠√É√ñ√Ω {√∫c¬ã¬ä√©6iSlC√´¬É-¬í¬ø√∑¬ü√Ø√±Q¬æ|√•^√å√ê!¬í√≤¬§k9‚Äù¬â√è¬ö¬Ñ]√´√ñhx¬°c!¬©p`√Ü√í¬µ√¶DZW¬∂>¬∏¬å7UDb¬Ç¬ÄA¬£¬å¬•¬µ¬µ`>`√∞¬ï(¬ôM√∏L√∏¬πD¬ù‚Äù√áS‚Äô√ª¬ës√ôgb√ñ¬µ@N√Ä¬èF√§¬û

algun tipo de ayuda para este casoo?? porfavor

Responder
Adriz dice:
3 diciembre, 2015 a las 12:15
Alguna ayuda Miguel??

Responder
Rodrigo dice:
19 abril, 2014 a las 21:47
Excelente librer√≠a, tuve un par de errores, como aporte dejare la soluci√≥n en agradecimiento:

Generaba el archivo pero me daba un error dec√≠a:

Excel no puede abrir el archivo ‚ÄòReportedealumnos.xlsx‚Äô por que el formato o la extensi√≥n de este no son validos‚Ä¶

Soluci√≥n, al menos para mi:

La librer√≠a utiliza php_zip.dll la cual esta comentareada en lo archivos de php.ini bueno como no sabia cual de todos descomentarear lo hice en todos, los cuales est√°n en las ubicaciones:

‚Äì c:\windows\php.ini
‚Äì c:\appserv\php5\php.ini-dist
‚Äì c:\appserv\php5\php.ini-recommended
‚Äì c:\AppServ\www\server\php\php.ini

Buscamos y cambiamos
;extension=php_zip.dll a extension=php_zip.dll

Si, sin el punto y coma del inicio, una vez hecho esto reiniciamos el servidor apache y todo funcionando de maravilla. Nuevamente gracias por la ayuda.

Responder
da dice:
27 noviembre, 2015 a las 10:16
amigo tengo el mismo problema que ten√≠as pero no encuentro los archivos ni la localizacion :S help !!!!!

Responder
Taty Andrade dice:
23 abril, 2014 a las 20:04
Muy buen aporte me sirvio de mucho.. pero tengo un problema no se si alguien le sucedi√≥ lo mismo; al momento de descargar el reporte me sale en la info de descarga ‚ÄúTiempo de descarga desconocido y jamas se descarga‚Äù; le quite la parte del codigo en la que se manda a la descarga y simplemente le puse que se guarde el archivo y se queda la pagina en espera como cargando, pero si crea el archivo y esta todo correcto‚Ä¶ ojala me puedan ayudar
Gracias

Responder
dani dice:
19 mayo, 2014 a las 13:30
Grandisimo aporte!!

Responder
johnny luis dice:
6 junio, 2014 a las 9:43
Lineas abajo te colocare mi codigo; mi problema es que se genera el excel pero sin ning√∫n resultado. favor te agradeceria tu ayuda

Ver Historial

var sp = ‚Äù;
function animaTitulo()
{
var actual = document.title;
document.title = actual.substr(1) + sp + actual.substring(0, 1);
if (navigator.appVersion.indexOf(‚ÄòMSIE‚Äô)>=0)
sp = (actual.substring(0, 1)==‚Äô ‚Äò)?‚Äù ‚Äú:‚Äù‚Äù;
setTimeout(‚ÄòanimaTitulo()‚Äô, 200);
}

Display();
include(‚Äúconectar.php‚Äù);
$link=conectar();

$resultado=mysql_query(‚Äúselect equipos_codigo,fecha,horometro,status from historial,status,servicios where servicios_idservicios=Idservicios and status_idstatus=Idstatus‚Äù,$link);

//$consulta = ‚ÄúSELECT* FROM historial INNER JOIN status ON status_idstatus=Idstatus ‚Äú;
//$consulta .= ‚Äù INNER JOIN servicios ON servicios_idservicios=Idservicios ‚Äú;

//$resultado = $link->query($consulta);
//$resultado = mysql_query($consulta);
if(mysql_num_rows($resultado) > 0 ){

date_default_timezone_set(‚ÄòAmerica/Mexico_City‚Äô);
if (PHP_SAPI == ‚Äòcli‚Äô)
die(‚ÄòEste archivo solo se puede ver desde un navegador web‚Äô);
/** Se agrega la libreria PHPExcel */
require_once ‚Äòlib/PHPExcel/PHPExcel.php‚Äô;

// Se crea el objeto PHPExcel
$objPHPExcel = new PHPExcel();
// Se asignan las propiedades del libro
$objPHPExcel->getProperties()->setCreator(‚ÄúCodedrinks‚Äù) // Nombre del autor
->setLastModifiedBy(‚ÄúCodedrinks‚Äù) //Ultimo usuario que lo modific√≥
->setTitle(‚ÄúReporte Excel con PHP y MySQL‚Äù) // Titulo
->setSubject(‚ÄúReporte Excel con PHP y MySQL‚Äù) //Asunto
->setDescription(‚ÄúReporte de alumnos‚Äù) //Descripci√≥n
->setKeywords(‚Äúreporte alumnos carreras‚Äù) //Etiquetas
->setCategory(‚ÄúReporte excel‚Äù); //Categorias
$tituloReporte = ‚ÄúReporte de historial‚Äù;
$titulosColumnas = array(‚ÄòEQUIPO‚Äô, ‚ÄòFECHA DE REPORTE‚Äô, ‚ÄòHOROMETRO‚Äô, ‚ÄòSTATUS‚Äô);
// Se combinan las celdas A1 hasta D1, para colocar ah√≠ el titulo del reporte
$objPHPExcel->setActiveSheetIndex(0)
->mergeCells(‚ÄòA1:D1‚Äô);
// Se agregan los titulos del reporte
$objPHPExcel->setActiveSheetIndex(0)
->setCellValue(‚ÄòA1‚Äô,$tituloReporte) // Titulo del reporte
->setCellValue(‚ÄòA3‚Äô, $titulosColumnas[0]) //Titulo de las columnas
->setCellValue(‚ÄòB3‚Äô, $titulosColumnas[1])
->setCellValue(‚ÄòC3‚Äô, $titulosColumnas[2])
->setCellValue(‚ÄòD3‚Äô, $titulosColumnas[3]);
//Se agregan los datos de los alumnos

$i = 4; //Numero de fila donde se va a comenzar a rellenar
while ($fila = mysql_fetch_array($resultado)) {
$objPHPExcel->setActiveSheetIndex(0)
->setCellValue(‚ÄòA‚Äô.$i, $fila[‚Äòequipos_codigo‚Äô])
->setCellValue(‚ÄòB‚Äô.$i, $fila[‚Äòfecha‚Äô])
->setCellValue(‚ÄòC‚Äô.$i, $fila[‚Äòhorometro‚Äô])
->setCellValue(‚ÄòD‚Äô.$i, $fila[‚Äòstatus‚Äô]);
$i++;
}
$estiloTituloReporte = array(
‚Äòfont‚Äô => array(
‚Äòname‚Äô => ‚ÄòVerdana‚Äô,
‚Äòbold‚Äô => true,
‚Äòitalic‚Äô => false,
‚Äòstrike‚Äô => false,
‚Äòsize‚Äô =>16,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚ÄòFFFFFF‚Äô
)
),
‚Äòfill‚Äô => array(
‚Äòtype‚Äô => PHPExcel_Style_Fill::FILL_SOLID,
‚Äòcolor‚Äô => array(
‚Äòargb‚Äô => ‚ÄòFF220835‚Äô)
),
‚Äòborders‚Äô => array(
‚Äòallborders‚Äô => array(
‚Äòstyle‚Äô => PHPExcel_Style_Border::BORDER_NONE
)
),
‚Äòalignment‚Äô => array(
‚Äòhorizontal‚Äô => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
‚Äòvertical‚Äô => PHPExcel_Style_Alignment::VERTICAL_CENTER,
‚Äòrotation‚Äô => 0,
‚Äòwrap‚Äô => TRUE
)
);

$estiloTituloColumnas = array(
‚Äòfont‚Äô => array(
‚Äòname‚Äô => ‚ÄòArial‚Äô,
‚Äòbold‚Äô => true,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚ÄòFFFFFF‚Äô
)
),
‚Äòfill‚Äô => array(
‚Äòtype‚Äô => PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR,
‚Äòrotation‚Äô => 90,
‚Äòstartcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äòc47cf2‚Äô
),
‚Äòendcolor‚Äô => array(
‚Äòargb‚Äô => ‚ÄòFF431a5d‚Äô
)
),
‚Äòborders‚Äô => array(
‚Äòtop‚Äô => array(
‚Äòstyle‚Äô => PHPExcel_Style_Border::BORDER_MEDIUM ,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äò143860‚Äô
)
),
‚Äòbottom‚Äô => array(
‚Äòstyle‚Äô => PHPExcel_Style_Border::BORDER_MEDIUM ,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äò143860‚Äô
)
)
),
‚Äòalignment‚Äô => array(
‚Äòhorizontal‚Äô=> PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
‚Äòvertical‚Äô => PHPExcel_Style_Alignment::VERTICAL_CENTER,
‚Äòwrap‚Äô => TRUE
)
);

$estiloInformacion = new PHPExcel_Style();
$estiloInformacion->applyFromArray( array(
‚Äòfont‚Äô => array(
‚Äòname‚Äô => ‚ÄòArial‚Äô,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äò000000‚Äô
)
),
‚Äòfill‚Äô => array(
‚Äòtype‚Äô => PHPExcel_Style_Fill::FILL_SOLID,
‚Äòcolor‚Äô => array(
‚Äòargb‚Äô => ‚ÄòFFd9b7f4‚Äô)
),
‚Äòborders‚Äô => array(
‚Äòleft‚Äô => array(
‚Äòstyle‚Äô => PHPExcel_Style_Border::BORDER_THIN ,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äò3a2a47‚Äô
)
)
)
));
$objPHPExcel->getActiveSheet()->getStyle(‚ÄòA1:D1‚Äô)->applyFromArray($estiloTituloReporte);
$objPHPExcel->getActiveSheet()->getStyle(‚ÄòA3:D3‚Äô)->applyFromArray($estiloTituloColumnas);
$objPHPExcel->getActiveSheet()->setSharedStyle($estiloInformacion, ‚ÄúA4:D‚Äù.($i-1));
for($i = ‚ÄòA‚Äô; $i setActiveSheetIndex(0)->getColumnDimension($i)->setAutoSize(TRUE);
}
// Se asigna el nombre a la hoja
$objPHPExcel->getActiveSheet()->setTitle(‚ÄòAlumnos‚Äô);

// Se activa la hoja para que sea la que se muestre cuando el archivo se abre
$objPHPExcel->setActiveSheetIndex(0);

// Inmovilizar paneles
//$objPHPExcel->getActiveSheet(0)->freezePane(‚ÄòA4‚Äô);
$objPHPExcel->getActiveSheet(0)->freezePaneByColumnAndRow(0,4);
// Se manda el archivo al navegador web, con el nombre que se indica, en formato 2007
header(‚ÄòContent-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet‚Äô);
header(‚ÄòContent-Disposition: attachment;filename=‚ÄùReportedealumnos.xlsx‚Äù‚Äò);
header(‚ÄòCache-Control: max-age=0‚Äô);

$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, ‚ÄòExcel2007‚Äô);
$objWriter->save(‚Äòphp://output‚Äô);
exit;
}
else{
print_r(‚ÄòNo hay resultados para mostrar‚Äô);
}

Responder
sun2012 dice:
11 junio, 2014 a las 18:55
Hola, para unir las tablas debes ocupar inner join, saludos.

Responder
ClikC dice:
6 junio, 2014 a las 15:07
Lo probrae gracias por el aporte.

Responder
alonso dice:
11 junio, 2014 a las 20:44
muy buenoo pero tengo un problema no se como poner la cabesera estaticaa k no se muva mejor dicho blokeado o inmovilizar una collumna bno se k funcion usar

Responder
jos√© dice:
16 junio, 2014 a las 3:36
Muchas gracias por este gran aporte. Me ha servido de mucho de verdad
Todo bien para consultas de tablas con pocos registros, pero he tenido problemas para consultas de muchos registros. Especificamente una consulta de 40000 registros aprox que me fatal error Maximum execution time of 60 seconds exceeded o ‚ÄúFatal error: Allowed memory size of 67108864 bytes exhausted (tried to allocate 32 bytes)‚Äù y me manda a los archivos PHPExcel/worksheet.php (no recuerdo las linas en este momento) o al archivo PHPExcel/Cell/DefaultValueBinder.php creo que la linea 1218.
ojo, me ha dado distintos errores a veces porque estuve probando para modificar los valores en php.ini ya que he estado probando en servidor local
Agradezco cualquier sugerencia que me puedan dar. Hasta pronto

Responder
Carlos dice:
18 junio, 2014 a las 8:12
Estimado Genial ,slaio de una . pero tengo0 una consulta como ahgo para que lo muestre en una pagina web antes de descargarlo en excel , si complentas con eso seria chevere

Responder
Edher dice:
18 junio, 2014 a las 8:48
Que tal buen dia, quisiera saber, si hay alguna opcion derecta en php para poder bloquear el archivo de Excel y no le hagan cambios.

Responder
alejon dice:
19 junio, 2014 a las 6:06
Donde puedo hallar la clase phpExcel?

Responder
alejon dice:
19 junio, 2014 a las 7:08
Ya halle la libreria, lo adapte a mi codigo pero esta pasando por este mensaje:No hay resultados para mostrar
si pudieran ayudarme.
este es mi codigo:

C√©dula:

Excel

<!‚Äì
‚Äì>

<?php

if ($_POST['cedula'] && $_POST['buscar'])
{
$consulta2 = "SELECT * FROM deuda WHERE deuda.cedula = '{$_POST['cedula']}' ORDER BY nroapto";
$consulta3 = @pg_query($connect,$consulta2);
}

que adapte al reporteexcel.php

Responder
DanielSquishy dice:
8 julio, 2014 a las 12:56
Cuando le doy click al link de descargar archivo, me manda el codigo fuente en la pagina, y no descarga nada que puedo hacer?

Responder
Rodrigo dice:
14 julio, 2014 a las 20:02
Tu interprete de apache no esta corriendo, dicho de otra manera ya revisaste si el servidor apache esta funcionando? o si la pagina esta alojada en la carpeta del servidor?

Responder
Angel De la Cruz dice:
29 julio, 2014 a las 12:24
Cuando descargo el archivo me aparece que esta da√±ado o que la extensi√≥n es incorrecta, y solo aparece un bot√≥n de aceptar y no abre nada. Que estaria pasando ahi?

Responder
Esar J. Ramirez dice:
31 julio, 2014 a las 15:24
Muchas, muchas, muchas, pero muchas gracias!!!

Responder
Nicol√°s dice:
23 agosto, 2014 a las 11:36
Hola! est√° muy bueno el tutorial peeeeero cuando descargo el archivo me tira que est√° da√±ado, vi que Angel de la cruz le pas√≥ lo mismo. Al abrir el archivo con notepad++ veo que al principio me agrega un espacio en blanco‚Ä¶ pero no encuentro d√≥nde se est√° agregando ese espacio‚Ä¶ que puede ser??

gracias!!!

Responder
fredy dice:
25 agosto, 2014 a las 10:34
Actualmente me encuentro desarrollando una peque√±a aplicaci√≥n web para la cual necesito la generaci√≥n de reportes .xls, para la aplicaci√≥n utilizo una arquitectura MVC donde no seria posible dejar todo en un solo .php como lo planteas. Al querer separarlo me permite descargar el archivo pero no es posible verlo desde excel y al abrirlo como archivo plano es totalmente ilegible.
quisiera saber como podr√≠a arreglar esto?

Responder
Israel Sanchez dice:
8 septiembre, 2014 a las 12:18
Woooooooooo ‚Ä¶‚Ä¶‚Ä¶.. excelente aporte amigo .. gracias ‚Ä¶. enserio gracias

Responder
Renn dice:
17 septiembre, 2014 a las 10:10
Muy bueno ! Me sirvio y es my facil de usar. Muchas gracias por tu trabajo

Responder
javierfer dice:
19 septiembre, 2014 a las 10:11
Great!

Responder
Antonio dice:
17 noviembre, 2014 a las 19:57
Buenas noches, me interesa contactar con usted, necesito realizar una libreria similar.
Cordialmente, Antonio

Responder
denker dice:
26 noviembre, 2014 a las 20:11
Hola amigo, puedes enviarme un correo a codedrinks@gmail.com

Responder
Francisco dice:
9 diciembre, 2014 a las 11:17
Tengo el siguiente c√≥digo

load(‚Äòformato_shell.csv‚Äô);
$nuevo = new PHPExcel();
$nuevo->setActiveSheetIndex(0);

for ($i = 0; $i getWorksheetIterator() as $worksheet){
foreach($worksheet->getRowIterator() as $row){
$cellIterator = $row->getCellIterator();
$cellIterator->setIterateOnlyExistingCells(false);
foreach($cellIterator as $cell){
$nuevo->getActiveSheet()->setCellValue($cell->getCoordinate(), $cell->getCalculatedValue());
$celda = substr($cell->getCoordinate(), 1);
$coord = (string)‚ÄùB$celda‚Äù;
if ($cell->getCalculatedValue() !== ‚ÄòProduct Quantity‚Äô){
if (trim($cell->getCalculatedValue()) === trim($claves[$i])){
echo ‚Äú‚Äù . $coord . ‚Äú‚Äù;
$nuevo->getActiveSheet()->setCellValue(‚Äú$coord‚Äù, $cantidades[$i]);
//$nuevo->getActiveSheet()->getCell(‚Äú$coord‚Äù)->setValue($cantidades[$i]);
//echo $nuevo->getActiveSheet()->getCell(‚Äú$coord‚Äù)->getValue();
//break;
}
}
}
}
}
}

$objWriter = PHPExcel_IOFactory::createWriter($nuevo, ‚ÄòCSV‚Äô);
$objWriter->save(‚ÄòP-001.csv‚Äô);

chmod(‚ÄòP-001.csv‚Äô, 0777);

lo que necesito es leer un archivo y copiar el contenido en otro pero cuando la clave de un producto coincide con las claves que contiene el archivo debo colocar en la celda BX la cantidad de producto que se va a pedir pero no lo hace parece que se inicializa o algo as√≠ y siempre se va vac√≠a la celda, espero me puedan ayudar

Responder
Javier Davila dice:
15 enero, 2015 a las 9:31
Excelente aporte. Gracias‚Ä¶ Es posible generar el reporte en formato Excel 2003 ?

Responder
fer dice:
2 febrero, 2015 a las 20:57
que buen aporte me sirvio de mucho gracias, y tengo una pregunta, como puedo agregar una imagen al reporte que se esta generando

Responder
Alexis dice:
11 febrero, 2015 a las 22:02
como puedo hacer que el excel reconozca las √± ???

Responder
Jaime Eduardo dice:
11 marzo, 2015 a las 18:16
Se pueden mostrar tambien imagenes jaladas de la base de datos e insertar en el archivo excel? las imagenes se guardan en un campo tipo blob. Gracias

Responder
maykol dice:
20 marzo, 2015 a las 9:13
buena ayuda! pero cuando intento abrir el reporte de excel me da error dice q el formato de la extencion no es valido que compruebe que el archivo no este da√±ado

Responder
jorge dice:
21 marzo, 2015 a las 11:11
no reconoce la extencion en office 2010, dice que esta da√±ado y no reconoce este formato

Responder
wilmer dice:
24 marzo, 2015 a las 9:24
Holas.. amigo Una sola Pregunta el codigo fuente solo sirver para axcel 2007 ? digo por que me sale archivo da√±ado ah estoy exportado axcel 2013..
Espero su Respuesta.. Saludos

Responder
ALBERTO dice:
17 abril, 2015 a las 15:33
Tengo un problema: en un campo generado por mi bd tengo datos con cero por la izquierda asi por ejemplo (012587), pero no me exporta el cero al excel, en este ejemplo digamos que la columa A contiene dichos valores como puedo ingresar el codigo del estilo para que me muestre, estuve revisando algunos tutoriales y al parecer esta es la funci√≥n PHPExcel_Cell_DataType::TYPE_STRING.
Agradecere sus respuestas de entemano

Responder
enrique dice:
26 abril, 2015 a las 23:19
Muy bien, gracias por el aporte

Responder
facundo dice:
2 mayo, 2015 a las 13:08
Buenos dias, como seria para crear la base de datos y la tabla, descargue el ejemplo y no me aparece, en el navegador me aparece lo siguiente:

Warning: mysqli::mysqli(): (HY000/1045): Access denied for user ‚Äòusuario‚Äô@‚Äôlocalhost‚Äô (using password: YES) in C:\xampp\htdocs\reporteexcel\reporteexcel.php on line 2
La conexi√É¬≥n con el servidor de base de datos fall√É¬≥: Access denied for user ‚Äòusuario‚Äô@‚Äôlocalhost‚Äô (using password: YES)

deduzco que es porque no tengo la base de datos

Responder
OSCAR dice:
12 mayo, 2015 a las 14:49
Amigo una inquietud yo corro la aplicacion, y me descarga el archivo. cuando lo abro me aparece esto
Fatal error: Class ‚ÄòZipArchive‚Äô not found in C:\AppServ\www\proyecto\lib\PHPExcel\PHPExcel\Writer\Excel2007.php on line 227

este es mi codigo que pudo pasar?

0){

date_default_timezone_set(‚ÄòAmerica/Bogota‚Äô);

if (PHP_SAPI == ‚Äòcli‚Äô)
die(‚ÄòEste archivo solo se puede ver desde un navegador web‚Äô);

/** Se agrega la libreria PHPExcel */
require_once ‚Äòlib/PHPExcel/PHPExcel.php‚Äô;

// Se crea el objeto PHPExcel
$objPHPExcel = new PHPExcel();

$objPHPExcel->getProperties()->setCreator(‚ÄúCodedrinks‚Äù) //Autor
->setLastModifiedBy(‚ÄúCodedrinks‚Äù) //Ultimo usuario que lo modific√≥
->setTitle(‚ÄúReporte Excel con PHP y MySQL‚Äù)
->setSubject(‚ÄúReporte Excel con PHP y MySQL‚Äù)
->setDescription(‚ÄúReporte de facilitador‚Äù)
->setKeywords(‚Äúreporte nombres facilitadores‚Äù)
->setCategory(‚ÄúReporte excel‚Äù);

$tituloReporte = ‚ÄúRelaci√≥n de facilitadores‚Äù;
$titulosColumnas = array(‚ÄòNUMERO DE DOCUMENTO‚Äô, ‚ÄòNOMBRES Y APELLIDOS‚Äô, ‚ÄòCODIGO‚Äô);

$objPHPExcel->setActiveSheetIndex(0)
->mergeCells(‚ÄòA1:C1‚Äô);

// Se agregan los titulos del reporte
$objPHPExcel->setActiveSheetIndex(0)
->setCellValue(‚ÄòA1‚Äô,$tituloReporte)
->setCellValue(‚ÄòA3‚Äô, $titulosColumnas[0])
->setCellValue(‚ÄòB3‚Äô, $titulosColumnas[1])
->setCellValue(‚ÄòC3‚Äô, $titulosColumnas[2]);

$i = 4;
while ($fila =mysql_fetch_array($resultado)){
$objPHPExcel->setActiveSheetIndex(0)
->setCellValue(‚ÄòA‚Äô.$i, $fila[‚Äòn_id‚Äô])
->setCellValue(‚ÄòB‚Äô.$i, $fila[‚Äònom_f‚Äô])
->setCellValue(‚ÄòC‚Äô.$i, $fila[‚Äòcodigo‚Äô]);
$i++;
}

$estiloTituloReporte = array(
‚Äòfont‚Äô => array(
‚Äòname‚Äô => ‚ÄòVerdana‚Äô,
‚Äòbold‚Äô => true,
‚Äòitalic‚Äô => false,
‚Äòstrike‚Äô => false,
‚Äòsize‚Äô =>16,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚ÄòFFFFFF‚Äô
)
),
‚Äòfill‚Äô => array(
‚Äòtype‚Äô	=> PHPExcel_Style_Fill::FILL_SOLID,
‚Äòcolor‚Äô	=> array(‚Äòargb‚Äô => ‚ÄòFF220835‚Äô)
),
‚Äòborders‚Äô => array(
‚Äòallborders‚Äô => array(
‚Äòstyle‚Äô => PHPExcel_Style_Border::BORDER_NONE
)
),
‚Äòalignment‚Äô => array(
‚Äòhorizontal‚Äô => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
‚Äòvertical‚Äô => PHPExcel_Style_Alignment::VERTICAL_CENTER,
‚Äòrotation‚Äô => 0,
‚Äòwrap‚Äô => TRUE
)
);

$estiloTituloColumnas = array(
‚Äòfont‚Äô => array(
‚Äòname‚Äô => ‚ÄòArial‚Äô,
‚Äòbold‚Äô => true,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚ÄòFFFFFF‚Äô
)
),
‚Äòfill‚Äô => array(
‚Äòtype‚Äô	=> PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR,
‚Äòrotation‚Äô => 90,
‚Äòstartcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äòc47cf2‚Äô
),
‚Äòendcolor‚Äô => array(
‚Äòargb‚Äô => ‚ÄòFF431a5d‚Äô
)
),
‚Äòborders‚Äô => array(
‚Äòtop‚Äô => array(
‚Äòstyle‚Äô => PHPExcel_Style_Border::BORDER_MEDIUM ,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äò143860‚Äô
)
),
‚Äòbottom‚Äô => array(
‚Äòstyle‚Äô => PHPExcel_Style_Border::BORDER_MEDIUM ,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äò143860‚Äô
)
)
),
‚Äòalignment‚Äô => array(
‚Äòhorizontal‚Äô => PHPExcel_Style_Alignment::HORIZONTAL_CENTER,
‚Äòvertical‚Äô => PHPExcel_Style_Alignment::VERTICAL_CENTER,
‚Äòwrap‚Äô => TRUE
));

$estiloInformacion = new PHPExcel_Style();
$estiloInformacion->applyFromArray(
array(
‚Äòfont‚Äô => array(
‚Äòname‚Äô => ‚ÄòArial‚Äô,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äò000000‚Äô
)
),
‚Äòfill‚Äô => array(
‚Äòtype‚Äô	=> PHPExcel_Style_Fill::FILL_SOLID,
‚Äòcolor‚Äô	=> array(‚Äòargb‚Äô => ‚ÄòFFd9b7f4‚Äô)
),
‚Äòborders‚Äô => array(
‚Äòleft‚Äô => array(
‚Äòstyle‚Äô => PHPExcel_Style_Border::BORDER_THIN ,
‚Äòcolor‚Äô => array(
‚Äòrgb‚Äô => ‚Äò3a2a47‚Äô
)
)
)
));

$objPHPExcel->getActiveSheet()->getStyle(‚ÄòA1:C1‚Äô)->applyFromArray($estiloTituloReporte);
$objPHPExcel->getActiveSheet()->getStyle(‚ÄòA3:C3‚Äô)->applyFromArray($estiloTituloColumnas);
$objPHPExcel->getActiveSheet()->setSharedStyle($estiloInformacion, ‚ÄúA4:C‚Äù.($i-1));

for($i = ‚ÄòA‚Äô; $i setActiveSheetIndex(0)
->getColumnDimension($i)->setAutoSize(TRUE);
}

// Se asigna el nombre a la hoja
$objPHPExcel->getActiveSheet()->setTitle(‚ÄòFacilitadores‚Äô);

// Se activa la hoja para que sea la que se muestre cuando el archivo se abre
$objPHPExcel->setActiveSheetIndex(0);
// Inmovilizar paneles
//$objPHPExcel->getActiveSheet(0)->freezePane(‚ÄòA4‚Äô);
$objPHPExcel->getActiveSheet(0)->freezePaneByColumnAndRow(0,4);

// Se manda el archivo al navegador web, con el nombre que se indica (Excel2007)
header(‚ÄòContent-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet‚Äô);
header(‚ÄòContent-Disposition: attachment;filename=‚ÄùReportedealumnos.xls‚Äù‚Äò);
header(‚ÄòCache-Control: max-age=0‚Äô);

$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, ‚ÄòExcel2007‚Äô);
$objWriter->save(‚Äòphp://output‚Äô);
exit;

}
else{
print_r(‚ÄòNo hay resultados para mostrar‚Äô);
}

?>

Responder
GALA dice:
1 octubre, 2015 a las 9:30
Saludos.
Yo ten√≠a el problema que al momento de generar el archivo no mostraba ning√∫n contenido, tengo Office 2013, as√≠ que puede ser por eso, no s√©, lo solucione cambiando est√°s l√≠neas:

header(‚ÄòContent-Disposition: attachment;filename=‚ÄùReportedealumnos.xlsx‚Äù‚Äò);
$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, ‚ÄòExcel2007‚Äô);

por:
header(‚ÄòContent-Disposition: attachment;filename=‚ÄùReportedealumnos.xls‚Äù‚Äò);
$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, ‚ÄòExcel5‚Äô);

El archivo generado es m√°s ‚Äúviejo‚Äù versi√≥n 97-2003. Espero les sea de ayuda.

Responder
elena dice:
5 octubre, 2015 a las 13:15
por que me marca error desde la 2 linea?
$conexion = new mysqli(‚Äòlocalhost‚Äô,‚Äôroot‚Äô,‚Äô1‚Ä≤,‚Äôconuee‚Äô,3306);
if (mysqli_connect_errno()) {
printf(‚ÄúLa conexi√≥n con el servidor de base de datos fall√≥: %s\n‚Äù, mysqli_connect_error());
exit();
}

Responder
sun2012 dice:
12 octubre, 2015 a las 19:39
Alg√∫n par√°metro de conexi√≥n esta mal.

Responder
Roberto dice:
13 octubre, 2015 a las 3:15
Buenos d√≠as, estoy teniendo un problema con una funci√≥n que crea un excel. A ver si alguno me puede echar un cable.

Resulta que yo tengo una funci√≥n donde:

‚Äì Extraigo datos de una base de datos.
‚Äì Configuro un excel con esos datos.
‚Äì Guardo el excel.

Hasta ah√≠ va bien.

El problema principal es que tengo varias tablas, y me gustar√≠a que cada tabla fuera una hoja distinta en el excel.

He intentado hacerlo de muchas maneras pero o no me lo hace, o necesito repetir el c√≥digo de creaci√≥n del excel una y otra vez, haciendo que el programa sea incre√≠blemente lento e inestable.

Por lo que por ahora, estoy creando el excel hoja a hoja y luego lo junto de forma manual, lo cual cuando haya muchos excel resultar√° tedioso.

Existir√≠a alguna forma de hacerlo? o estoy diciendo locuras?

Hasta ahora he intentado:

‚Äì Crear otra funci√≥n fuera que cargue el excel y meterlas todas antes del $objWriter->save($documento);
‚Äì Repetir el c√≥digo una y otra vez de todas las tablas. Funciona a medias porque como digo da problemas el tiempo de conexi√≥n, porque las tablas son muy grandes.
-Llamar a la funci√≥n save desde donde invoco a la funci√≥n y crear la nueva hoja all√≠, el problema es que no me reconoce como que he creado una hoja y al intentar escribir en la segunda me dice que no puede porque solo hay una.
‚Äì

Responder
Roberto dice:
13 octubre, 2015 a las 6:32
Joe, bastaba que preguntara algo en alg√∫n lugar para que encontrara la soluci√≥n jaja.

Al final lo resolv√≠ haciendo cada Excel por separado y luego uniendolos todos mediante el addexternalsheet.

Pongo el c√≥digo por si alguno lo necesita:

//Hay que borrar el archivo si ya existe, si no da conflicto
if (file_exists(‚Äúlista_excel/ruta del fichero‚Äù)) {
unlink (‚Äúfichero‚Äù);
}

//lleno el array con la ruta de los archivos que quiero unir.

$listas=array();
$directorio = opendir(‚Äúlista_excel/‚Äù); //ruta actual
while ($archivo = readdir($directorio)) //obtenemos un archivo y luego otro sucesivamente
{
if ($archivo != ‚Äò.‚Äô && $archivo != ‚Äò..‚Äô)
{
if (is_dir($archivo))//verificamos si es o no un directorio
{
echo ‚Äú[‚Äú.$archivo . ‚Äú]‚Äù; //de ser un directorio lo envolvemos entre corchetes
}
else
{
$listas[]=‚Äôlista_excel/‚Äô.$archivo;
}
}
}
//comprobaci√≥n de que el array se est√° llenando bien
/*for($f=0;$f<count($lista);$f++)
{
echo $lista[$f];
echo "‚Äù;
} */

require_once ‚Äòlibs/phpexcel/Classes/PHPExcel.php‚Äô;
$bigExcel = new PHPExcel();
//hay que remover la primera ya que al agregar las otras siempre crea una.
$bigExcel->removeSheetByIndex(0);
$objReader = new PHPExcel_Reader_Excel2007();

//cargame cada elemento del array
foreach ($listas as $lista) {
$excel = $objReader->load($lista);
//agregame las hojas
foreach ($excel->getAllSheets() as $sheet) {
$bigExcel->addExternalSheet($sheet);
}

foreach ($excel->getNamedRanges() as $namedRange) {
$bigExcel->addNamedRange($namedRange);
}
}

$writer = new PHPExcel_Writer_Excel2007($bigExcel);
$writer->save(‚Äòruta del nuevo archivo a crear.xlsx‚Äô);

Responder
Antonio dice:
21 octubre, 2015 a las 0:02
Que tal, buen aporte, tengo un problema, al generar el archivo en el valor de la variable $tituloReporte no me aparece el valor que se le da a la variable, en lugar me aparece la palabra FALSO.

Responder
Jhon Jame Piguave Herrera dice:
25 octubre, 2015 a las 17:28
Cuando subo el archivo a un hospedaje web no funciona,
en localhost es perfecto, pero en la web no muestra nada

Responder
Adriz dice:
3 diciembre, 2015 a las 11:57
Mi archivo me env√≠a puros signos raros, por que??? En que parte tengo que modificar

Otra cosa me pone mi consulta pero jamas me pone el estilo ni el nombre de las columnas,

Gracias y buen dia a todos

Responder
Edwin dice:
17 diciembre, 2015 a las 13:51
Buenas tardes,
Me puedes informar si esta clase me sirve para exportar a Excel datos de una bdd Oracle.

Responder
cesar dice:
31 enero, 2016 a las 15:42
buenas tardes, funciona la libreria phpexcel y todo pero si se quiere q el usuario final modifique todos los datos q quiera en excel y haga lo que quiera con formulas y eso‚Ä¶..
por que estos datos al parecer quedan como bloqueados.

cual es la solucion gracias

Responder
mike dice:
2 febrero, 2016 a las 12:19
En donde declaro que tabla es la que quiero que me cree el reporte?

Responder
sun2012 dice:
4 febrero, 2016 a las 19:37
En la consulta sql

Responder
DEJA UN COMENTARIO


 
CATEGOR√çAS
C SHARP
CODEIGNITER
CSS
CURSO BASICO PHP
DESARROLLO M√ìVIL
DESARROLLO WEB
DJANGO
FLASH
FRAMEWORKS PHP
HERRAMIENTAS
HTML5
ICONOS
ILLUSTRATOR
INFOGRAFIA
INTERNET
JAVA
JAVASCRIPT
JQUERY
LARAVEL
LINUX
MYSQL
NODEJS
OCIO
PHOTOSHOP
PHP
PYTHON
RECOMENDACIONES
RECURSOS
SEO
SERVIDORES
SIN CATEGOR√çA
SNIPPETS
SOFTWARE
TUTORIALES
VIDEOTUTORIALES
BitMagnum
FACEBOOK

A√ë√ÅDENOS A TUS C√çRCULOS

LO M√ÅS LE√çDO
Crear un reporte en Excel con PHP y MySQL
Ejemplo jQgrid: Mostrar datos de una base de datos MySQL
Crear un reporte con FPDF usando PHP y MySQL
Como subir una pagina web a internet paso a paso
Restablecer contrase√±a mediante correo electr√≥nico con PHP y MySQL
Caja de texto con opci√≥n de autocompletado utilizando PHP, MySQL y jQuery
Google API Chart: Ejemplo de grafica de barras con PHP, jQuery y MySQL
LO M√ÅS RECIENTE
Curso Java: Introducci√≥n
Crud PHP y MySQL
PageSpeed Insights
ED GRID Framework Css
FORO PHP Y MYSQL ‚Äì FINAL
Can I use
Font Awesome ‚Äì Letras tipo iconos
TinyPNG: compresor de im√°genes png
¬©2016 Codedrinks 
